<!doctype html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,user-scalable=no,initial-scale=1,maximum-scale=1,minimum-scale=1"><meta http-equiv="X-UA-Compatible" content="ie=edge"><meta name="keywords" content="腾讯课堂以及各种文库下载实现自动化,个人网站，个人博客，meethigher，学习，生活"><meta name="description" content="今天上线代课，老师抽查了一次签到，我没签上，应该按旷课处理了。并不是我上课态度不端正，实在是这老师就是个混子，混吃等死那种。听他课还不如自己看书刷题。"><title>腾讯课堂以及各种文库下载实现自动化</title><link rel="shortcut icon" href="/blog/images/favicon.ico"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/meethigher/cdn@9.0/css/meethigher-font.css"><link rel="stylesheet" href="/blog/css/index.css"></head><body><header class="header"><div class="header-menu"><span class="fa fa-bars"></span></div><div class="header-search"><span class="fa fa-search"></span></div><div class="header-title"><a href="/">言成言成啊<span class="header-subtitle"> | Kit Chen&#39;s Blog</span></a></div><ul class="header-navbar clearFix"><li><a href="/blog/">主页</a></li><li><a href="/blog/tags">标签</a></li><li><a href="/blog/archives">归档</a></li><li><a href="/blog/about">关于</a></li></ul></header><div id="particles-js"></div><script src="https://cdn.jsdelivr.net/gh/meethigher/cdn@9.0/js/particles.min.js"></script><script src="https://cdn.jsdelivr.net/gh/meethigher/cdn@9.0/js/app.js"></script><div class="search" title="站内搜索"><span class="fa fa-search"></span></div><div class="tool"><div class="up" title="返回顶部"><span class="fa fa-long-arrow-up"></span></div><div class="down" title="返回底部"><span class="fa fa-long-arrow-down"></span></div><a href="/blog/app.apk" class="app" title="下载App" download="app.apk"><span class="fa fa-android"></span></a></div><main class="main"><div class="main-content"><article class="post"><div class="post-title"><h2 class="title">腾讯课堂以及各种文库下载实现自动化</h2></div><div class="post-content blog-markdown"><p>本着开源分享的精神，我把代码发到了b站上和博客上。</p><p>这个解决问题的想法并非我原创，网上有好多教程，比我早。而且这个一开始也是跟我自己的思路有点出入的。只能算是我对其的一个扩展。供大家学习使用。</p><h1 id="腾讯课堂"><a href="#腾讯课堂" class="headerlink" title="腾讯课堂"></a>腾讯课堂</h1><p><a href="https://b23.tv/BV1Lz41187RR" target="_blank" rel="noopener">腾讯课堂实现自动化</a></p><p>打开<code>chrome</code>浏览器（其他的也可以，chrome最好啦）。</p><p>打开<code>开发者工具</code>，直接将代码复制到<code>console</code>栏，按<code>enter</code>键即可。如果还不会用，就点击上面的那个链接。</p><blockquote><p>注意</p><ul><li>后台运行。有的小伙伴不太会用，解释一下。代码复制到console栏之后，自己就可以做别的事去了，哪怕你把浏览器最小化都行。只要不关闭页面，代码就会一直运行。</li><li>怎么知道有没有签到成功？签到的话，会在console栏里面输出“xxx时间完成签到”、“xxx时间完成确定”字样。输出信息，那就是在你这里已经签上了，老师那边如果没数据，就是老师的事，要不就是网络的事。我前几天碰到过，三次签到都没记录，我跟老师说我全签了，然后他重新下载记录，就有了。下课之后可以看console。如果太多信息，覆盖了结果，可以参照我下图的设置。用完了再还原Default就行</li></ul></blockquote><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAANSURBVBhXYzh8+PB/AAffA0nNPuCLAAAAAElFTkSuQmCC" data-original="/blog/2020/txkt-automation/5.png" title="设置"><h2 id="1-开启自动任务"><a href="#1-开启自动任务" class="headerlink" title="1 开启自动任务"></a>1 开启自动任务</h2><h3 id="自动送花"><a href="#自动送花" class="headerlink" title="自动送花"></a>自动送花</h3><p>开启一个<code>3秒</code>送花的定时器：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> flower=setInterval(<span class="function"><span class="keyword">function</span> (<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="built_in">document</span>.getElementsByClassName(<span class="string">"toolbar-icon"</span>)[<span class="number">2</span>].click();</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"送花"</span>);</span><br><span class="line">&#125;,<span class="number">3000</span>);</span><br></pre></td></tr></table></figure><h3 id="自动签到"><a href="#自动签到" class="headerlink" title="自动签到"></a>自动签到</h3><p>开启一个每隔<code>10秒</code>检测一次是否有签到按钮的定时器，有的话就点击：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> btns;</span><br><span class="line"><span class="keyword">let</span> attend=setInterval(<span class="function"><span class="keyword">function</span> (<span class="params"></span>)</span>&#123;</span><br><span class="line">    btns=<span class="built_in">document</span>.getElementsByClassName(<span class="string">"s-btn s-btn--primary s-btn--m"</span>);</span><br><span class="line">    <span class="keyword">if</span>(btns.length&gt;<span class="number">0</span>)&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="keyword">new</span> <span class="built_in">Date</span>().toLocaleTimeString()+<span class="string">"--完成--&gt;"</span>+btns[<span class="number">0</span>].innerText);</span><br><span class="line">        btns[<span class="number">0</span>].click();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;,<span class="number">10000</span>);</span><br></pre></td></tr></table></figure><h3 id="自动签到升级版"><a href="#自动签到升级版" class="headerlink" title="自动签到升级版"></a>自动签到升级版</h3><p>如果不是刚需的话，这个版本，我不推荐用的。里面有很多bug。只是实现功能的话，很简单，代码也不多，但是如果要把代码完善起来，就要很多代码了，目前我还没那么多时间整这个。所以，将就着用吧，代码的话，还是最初实现的版本，我没深入去优化了。</p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAANSURBVBhXYzh8+PB/AAffA0nNPuCLAAAAAElFTkSuQmCC" data-original="/blog/2020/txkt-automation/6.png" title="建议"><p>也是有小伙伴要的功能，仔细一想，好像我也会用到。</p><p>环境：</p><ul><li>浏览器：<a href="https://www.google.cn/chrome/" target="_blank" rel="noopener">Google Chrome</a></li><li>Chrome扩展：<a href="https://chrome.google.com/webstore/detail/tampermonkey/dhdgffkkebhmkfjojejmpbldmpobfkfo?hl=zh-CN" target="_blank" rel="noopener">TamperMonkey</a></li></ul><p>具体安装过程：</p><ol><li>挂梯子，翻墙（免费的话，推荐蓝灯-&gt;下载地址<a href="https://raw.githubusercontent.com/getlantern/lantern-binaries/master/lantern-installer.apk" target="_blank" rel="noopener">android</a>，<a href="https://raw.githubusercontent.com/getlantern/lantern-binaries/master/lantern-installer.exe" target="_blank" rel="noopener">windows</a>，<a href="https://raw.githubusercontent.com/getlantern/lantern-binaries/master/lantern-installer.dmg" target="_blank" rel="noopener">mac</a>）</li><li>打开上面Chrome扩展后面的链接，点击安装</li><li>安装之后，右上角会出来个猴子的标志，没有的话，点击管理扩展程序，启用即可</li><li>点击猴子，点击添加新脚本，保存即可</li></ol><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAANSURBVBhXYzh8+PB/AAffA0nNPuCLAAAAAElFTkSuQmCC" data-original="/blog/2020/txkt-automation/7.png"> <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAANSURBVBhXYzh8+PB/AAffA0nNPuCLAAAAAElFTkSuQmCC" data-original="/blog/2020/txkt-automation/8.png"> <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAANSURBVBhXYzh8+PB/AAffA0nNPuCLAAAAAElFTkSuQmCC" data-original="/blog/2020/txkt-automation/9.png"><p>具体的代码</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ==UserScript==</span></span><br><span class="line"><span class="comment">// @name         txkt-automation</span></span><br><span class="line"><span class="comment">// @namespace    http://meethigher.top/blog/2020/txkt-automation/</span></span><br><span class="line"><span class="comment">// @version      1.0</span></span><br><span class="line"><span class="comment">// @description  有小伙伴提到这个功能，正好我自己也会用到，就整了。用于腾讯课堂的自动签到</span></span><br><span class="line"><span class="comment">// @author       Kit Chen</span></span><br><span class="line"><span class="comment">// @match        https://ke.qq.com/webcourse/index.html</span></span><br><span class="line"><span class="comment">// @grant        none</span></span><br><span class="line"><span class="comment">// @提示          如果使用过程中出现问题，清除一下cookie就行，不用清除浏览器的所有数据，清除cookie就行</span></span><br><span class="line"><span class="comment">// ==/UserScript==</span></span><br><span class="line">(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line"><span class="meta">    'use strict'</span>;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">autoAttend</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">let</span> btns;</span><br><span class="line">        <span class="keyword">let</span> attend = setInterval(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">            btns = <span class="built_in">document</span>.getElementsByClassName(<span class="string">"s-btn s-btn--primary s-btn--m"</span>);</span><br><span class="line">            <span class="keyword">if</span> (btns.length &gt; <span class="number">0</span>) &#123;</span><br><span class="line">                <span class="built_in">console</span>.log(<span class="keyword">new</span> <span class="built_in">Date</span>().toLocaleTimeString() + <span class="string">"--完成--&gt;"</span> + btns[<span class="number">0</span>].innerText);</span><br><span class="line">                btns[<span class="number">0</span>].click();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;, <span class="number">10000</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">showBtn</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">let</span> $<span class="keyword">switch</span> = <span class="built_in">document</span>.createElement(<span class="string">"span"</span>);</span><br><span class="line">        <span class="keyword">let</span> $body = <span class="built_in">document</span>.querySelector(<span class="string">".web"</span>);</span><br><span class="line">        <span class="keyword">let</span> show = <span class="literal">true</span>;</span><br><span class="line">        $<span class="keyword">switch</span>.innerText = <span class="string">"显示/隐藏"</span>;</span><br><span class="line">        $<span class="keyword">switch</span>.style = <span class="string">"position:absolute;top:21px;right:520px;color:#AAAAAA;border-radius:10px;cursor:pointer;z-index:3000"</span>;</span><br><span class="line">        $<span class="keyword">switch</span>.onclick = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="keyword">if</span> (show) &#123;</span><br><span class="line">                <span class="built_in">document</span>.querySelector(<span class="string">".study-body.mr"</span>).style = <span class="string">"right:0;z-index:999"</span>;</span><br><span class="line">                show = <span class="literal">false</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="built_in">document</span>.querySelector(<span class="string">".study-body.mr"</span>).style = <span class="string">"right:300px;z-index:0"</span>;</span><br><span class="line">                show = <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        $body.appendChild($<span class="keyword">switch</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">clearRefresh</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="built_in">window</span>.localStorage.removeItem(<span class="string">"refresh"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">autoRefresh</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="built_in">window</span>.localStorage.setItem(<span class="string">"refresh"</span>, <span class="string">"no"</span>);</span><br><span class="line">        <span class="keyword">let</span> response = prompt(<span class="string">"请输入上课时间的前2分钟，并点击确定按钮开始执行自动刷新！"</span>, <span class="string">"13:28"</span>);</span><br><span class="line">        <span class="keyword">if</span> (response !== <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">let</span> arr = response.trim().split(<span class="string">":"</span>);</span><br><span class="line">            <span class="keyword">let</span> date;</span><br><span class="line">            <span class="keyword">let</span> timid = setInterval(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">                date = <span class="keyword">new</span> <span class="built_in">Date</span>();</span><br><span class="line">                <span class="keyword">if</span> (date.getHours() == <span class="built_in">parseInt</span>(arr[<span class="number">0</span>]) &amp;&amp; date.getMinutes() == <span class="built_in">parseInt</span>(arr[<span class="number">1</span>])) &#123;</span><br><span class="line">                    <span class="built_in">window</span>.location.reload();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;, <span class="number">1000</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            clearRefresh();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">isRefresh</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">let</span> isRefresh = <span class="built_in">window</span>.localStorage.getItem(<span class="string">"refresh"</span>) || <span class="string">"yes"</span>;</span><br><span class="line">        <span class="built_in">console</span>.log(isRefresh);</span><br><span class="line">        <span class="keyword">if</span> (isRefresh == <span class="string">"yes"</span>) &#123;</span><br><span class="line">            autoRefresh();</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            clearRefresh();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    isRefresh();</span><br><span class="line">    autoAttend();</span><br><span class="line">    showBtn();</span><br><span class="line">&#125;)();</span><br></pre></td></tr></table></figure><h3 id="自动刷屏"><a href="#自动刷屏" class="headerlink" title="自动刷屏"></a>自动刷屏</h3><p>每隔<code>3秒</code>发送<code>886</code></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> say = setInterval(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">document</span>.getElementsByClassName(<span class="string">"ql-editor"</span>)[<span class="number">0</span>].firstElementChild.innerText = <span class="string">"886"</span>;</span><br><span class="line">&#125;, <span class="number">3000</span>);</span><br><span class="line"><span class="keyword">let</span> say2 = setInterval(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">document</span>.getElementsByClassName(<span class="string">"text-editor-btn"</span>)[<span class="number">0</span>].click();</span><br><span class="line">&#125;, <span class="number">3000</span>)</span><br></pre></td></tr></table></figure><h3 id="下课自动发886"><a href="#下课自动发886" class="headerlink" title="下课自动发886"></a>下课自动发886</h3><p>设置好下课的时间，比如我的线代下课时间是<code>16:50</code>，自动发送<code>886</code>。</p><p>这个执行了之后会自动关闭，如果在执行之前想关闭，请跳转到<a href="#关闭下课提示">这里关闭下课提示</a></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> targetHour = <span class="string">"16"</span>;</span><br><span class="line"><span class="keyword">let</span> targetMin = <span class="string">"50"</span>;</span><br><span class="line"><span class="keyword">let</span> date;</span><br><span class="line"><span class="keyword">let</span> inputed = <span class="literal">false</span>;</span><br><span class="line"><span class="keyword">let</span> timing = setInterval(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    date = <span class="keyword">new</span> <span class="built_in">Date</span>();</span><br><span class="line">    <span class="keyword">if</span> (date.getHours() == <span class="built_in">parseInt</span>(targetHour) &amp;&amp; date.getMinutes() == <span class="built_in">parseInt</span>(targetMin)) &#123;</span><br><span class="line">        <span class="keyword">if</span> (!inputed) &#123;</span><br><span class="line">            <span class="built_in">document</span>.getElementsByClassName(<span class="string">"ql-editor"</span>)[<span class="number">0</span>].firstElementChild.innerText = <span class="string">"886"</span></span><br><span class="line">            inputed = <span class="literal">true</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="built_in">document</span>.getElementsByClassName(<span class="string">"text-editor-btn"</span>)[<span class="number">0</span>].click();</span><br><span class="line">            <span class="built_in">window</span>.clearInterval(timing);</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">"下课咯！"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;, <span class="number">1000</span>);</span><br></pre></td></tr></table></figure><h3 id="显示-隐藏对话框"><a href="#显示-隐藏对话框" class="headerlink" title="显示/隐藏对话框"></a>显示/隐藏对话框</h3><p>有小伙伴要这个功能，然后就加了一下</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> $<span class="keyword">switch</span> = <span class="built_in">document</span>.createElement(<span class="string">"span"</span>);</span><br><span class="line"><span class="keyword">let</span> $body = <span class="built_in">document</span>.querySelector(<span class="string">".web"</span>);</span><br><span class="line"><span class="keyword">let</span> show = <span class="literal">true</span>;</span><br><span class="line">$<span class="keyword">switch</span>.innerText = <span class="string">"显示/隐藏"</span>;</span><br><span class="line">$<span class="keyword">switch</span>.style = <span class="string">"position:absolute;top:21px;right:520px;color:#AAAAAA;border-radius:10px;cursor:pointer;z-index:3000"</span>;</span><br><span class="line">$<span class="keyword">switch</span>.onclick = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (show) &#123;</span><br><span class="line">        <span class="built_in">document</span>.querySelector(<span class="string">".study-body.mr"</span>).style = <span class="string">"right:0;z-index:999"</span>;</span><br><span class="line">        show = <span class="literal">false</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="built_in">document</span>.querySelector(<span class="string">".study-body.mr"</span>).style = <span class="string">"right:300px;z-index:0"</span>;</span><br><span class="line">        show = <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">$body.appendChild($<span class="keyword">switch</span>);</span><br></pre></td></tr></table></figure><p>效果如图：</p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAANSURBVBhXYzh8+PB/AAffA0nNPuCLAAAAAElFTkSuQmCC" data-original="/blog/2020/txkt-automation/4.png" title="显示&#x2F;隐藏"><h2 id="2-关闭自动任务"><a href="#2-关闭自动任务" class="headerlink" title="2 关闭自动任务"></a>2 关闭自动任务</h2><h3 id="关闭送花"><a href="#关闭送花" class="headerlink" title="关闭送花"></a>关闭送花</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(flower)&#123;</span><br><span class="line">    <span class="built_in">window</span>.clearInterval(flower);</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"已关闭送花"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="关闭签到"><a href="#关闭签到" class="headerlink" title="关闭签到"></a>关闭签到</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(attend)&#123;</span><br><span class="line">    <span class="built_in">window</span>.clearInterval(attend);</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"已关闭签到"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="关闭刷屏"><a href="#关闭刷屏" class="headerlink" title="关闭刷屏"></a>关闭刷屏</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(say)&#123;</span><br><span class="line">    <span class="built_in">window</span>.clearInterval(say);</span><br><span class="line">    <span class="built_in">window</span>.clearInterval(say2);</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"已关闭刷屏"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="关闭下课提示"><a href="#关闭下课提示" class="headerlink" title="关闭下课提示"></a>关闭下课提示</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(timing)&#123;</span><br><span class="line">    <span class="built_in">window</span>.clearInterval(timing);</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"提前关闭下课提示"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="3-今天上课的小插曲"><a href="#3-今天上课的小插曲" class="headerlink" title="3 今天上课的小插曲"></a>3 今天上课的小插曲</h2><p>一开始刚测试送花的时候，我开的是1秒送一个，估计是太活跃了，直接让马原老师，叫起来提问问题了。</p><p>我一脸懵逼啊，还好有大佬江湖救急。</p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAANSURBVBhXYzh8+PB/AAffA0nNPuCLAAAAAElFTkSuQmCC" data-original="/blog/2020/txkt-automation/1.png" title="插曲"><p>还有一个小插曲，就是马原老师问了一个问题，“越南是什么党派？”。</p><p>然后，下面一堆回复共产党。老师说，他直接被腾讯警告了。</p><p>哈哈，太难了也！</p><h1 id="文库下载"><a href="#文库下载" class="headerlink" title="文库下载"></a>文库下载</h1><p><a href="https://www.bilibili.com/video/BV1gV411Z7YS/" target="_blank" rel="noopener">超简单！学生如何免费下载文档，一看就会</a></p><p>刚才在做英语练习题的时候，做完了，想对一下答案，就百度了搜了一下，进去一个文库。</p><p>下载文档要12块钱，我就看了一下，上面预览的都是图片，所以就想着，js批量把图片下载下来，然后合成pdf，就正常看了，关键是没花钱啊，要不用浪费多长时间。</p><p>具体的使用我放到youtube的<a href="https://youtu.be/UXI-_SBcw7o" target="_blank" rel="noopener">文库免费下载小技巧</a>，本来想往b站传的，但是被驳回锁定了。下面放上代码吧。</p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAANSURBVBhXYzh8+PB/AAffA0nNPuCLAAAAAElFTkSuQmCC" data-original="/blog/2020/txkt-automation/3.png" title="只不过是程序代替了手动"><h2 id="1-示例淘豆网"><a href="#1-示例淘豆网" class="headerlink" title="1 示例淘豆网"></a>1 示例淘豆网</h2><p>淘豆网就是直接把图片放出来了，咱们直接下手就行。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">download</span>(<span class="params">url, fileName</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> xhr = <span class="keyword">new</span> XMLHttpRequest();</span><br><span class="line">    xhr.open(<span class="string">'GET'</span>, url, <span class="literal">true</span>);<span class="comment">//true表示异步</span></span><br><span class="line">    xhr.responseType = <span class="string">'blob'</span>;</span><br><span class="line">    xhr.onload = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (xhr.status === <span class="number">200</span>) &#123;</span><br><span class="line">           downloadByA(xhr.response,fileName);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">    xhr.send();</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">downloadByA</span>(<span class="params">data,fileName</span>)</span>&#123;</span><br><span class="line">	<span class="keyword">let</span> urlObject = <span class="built_in">window</span>.URL || <span class="built_in">window</span>.webkitURL || <span class="built_in">window</span>;</span><br><span class="line">	<span class="keyword">let</span> export_blob=<span class="keyword">new</span> Blob([data]);</span><br><span class="line">	<span class="keyword">let</span> a=<span class="built_in">document</span>.createElement(<span class="string">"a"</span>);</span><br><span class="line">	a.href=urlObject.createObjectURL(export_blob);</span><br><span class="line">	a.download=fileName;</span><br><span class="line">	a.click();</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//下面这块代码需要按自己需求，进行稍微地修改，上面两块代码可以不用动</span></span><br><span class="line"><span class="built_in">document</span>.querySelectorAll(<span class="string">".pageBox img"</span>).forEach(<span class="function"><span class="keyword">function</span>(<span class="params">ele, i</span>) </span>&#123;</span><br><span class="line">    download(ele.src,i+<span class="string">".jpg"</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>然后将下载出的图片合成pdf，就ok了</p><p>点击进入<a href="https://www.taodocs.com/p-134597690.html" target="_blank" rel="noopener">淘豆网示例网址</a></p><h2 id="2-示例道客巴巴"><a href="#2-示例道客巴巴" class="headerlink" title="2 示例道客巴巴"></a>2 示例道客巴巴</h2><p>道客巴巴就有点小心眼了，他把所有的预览图片，都转成了canvas形式的，那也没事，咱们同样用代码给他转回来。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">download</span>(<span class="params">url, fileName</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> xhr = <span class="keyword">new</span> XMLHttpRequest();</span><br><span class="line">    xhr.open(<span class="string">'GET'</span>, url, <span class="literal">true</span>);<span class="comment">//true表示异步</span></span><br><span class="line">    xhr.responseType = <span class="string">'blob'</span>;</span><br><span class="line">    xhr.onload = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (xhr.status === <span class="number">200</span>) &#123;</span><br><span class="line">           downloadByA(xhr.response,fileName);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">    xhr.send();</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">downloadByA</span>(<span class="params">data,fileName</span>)</span>&#123;</span><br><span class="line">	<span class="keyword">let</span> urlObject = <span class="built_in">window</span>.URL || <span class="built_in">window</span>.webkitURL || <span class="built_in">window</span>;</span><br><span class="line">	<span class="keyword">let</span> export_blob=<span class="keyword">new</span> Blob([data]);</span><br><span class="line">	<span class="keyword">let</span> a=<span class="built_in">document</span>.createElement(<span class="string">"a"</span>);</span><br><span class="line">	a.href=urlObject.createObjectURL(export_blob);</span><br><span class="line">	a.download=fileName;</span><br><span class="line">	a.click();</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//下面这块代码需要按自己需求，进行稍微地修改，上面两块代码可以不用动</span></span><br><span class="line"><span class="built_in">document</span>.querySelectorAll(<span class="string">".outer_page .inner_page"</span>).forEach(<span class="function"><span class="keyword">function</span>(<span class="params">ele, i</span>) </span>&#123;</span><br><span class="line">    download(ele.toDataURL(<span class="string">"image/jpeg"</span>),i+<span class="string">".jpg"</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>点击进入<a href="https://www.doc88.com/p-7337496651450.html" target="_blank" rel="noopener">道客巴巴示例网址</a></p><h2 id="3-示例百度文库"><a href="#3-示例百度文库" class="headerlink" title="3 示例百度文库"></a>3 示例百度文库</h2><p>百度文库有文字显示的，也有图片显示的，这里主要针对图片显示的，文字的我也看了太麻烦了。</p><p>但是在处理图片的过程中也出了问题，涉及到跨域的问题</p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAANSURBVBhXYzh8+PB/AAffA0nNPuCLAAAAAElFTkSuQmCC" data-original="/blog/2020/txkt-automation/2.png" title="百度文库"><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">document</span>.querySelectorAll(<span class="string">".mod.reader-page.complex.hidden-doc-banner .inner .bd .reader-pic-item"</span>).forEach(<span class="function"><span class="keyword">function</span>(<span class="params">ele, i</span>) </span>&#123;</span><br><span class="line">    download(ele.style.backgroundImage.match(<span class="regexp">/[^url("].*[^")]/</span>)[<span class="number">0</span>],i+<span class="string">".jpg"</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>点击进入<a href="https://wenku.baidu.com/view/3dce4d3e02d8ce2f0066f5335a8102d276a261d2" target="_blank" rel="noopener">百度文库示例网址</a>，网址放到这里，留着以后有时间再研究。准备上数学课了。</p><h2 id="4-关于合成pdf"><a href="#4-关于合成pdf" class="headerlink" title="4 关于合成pdf"></a>4 关于合成pdf</h2><p>现在工具很多，有免费在线版，也有免费的客户端，给大家推荐两款吧。</p><ol><li><a href="https://smallpdf.com/" target="_blank" rel="noopener">免费在线转pdf</a></li><li><a href="https://acrobat.adobe.com/cn/zh-Hans/acrobat.html" target="_blank" rel="noopener">adobe acrobat</a></li></ol><p>我是用的acrobat这个软件，这个比较好用，还可以去水印之类的。在我之前去水印的文章里，有提到过。</p></div><div class="post-detail">发布：2020-04-17 18:52:04<br>修改：2020-09-18 22:13:45<br>链接：<span class="shareUrl">https://meethigher.top/blog/2020/txkt-automation/</span><br>标签：<span><a href="/blog/tags/open/">open</a>&nbsp;<a href="/blog/tags/acrobat/">acrobat</a>&nbsp;<a href="/blog/tags/javascript/">javascript</a>&nbsp;</span></div><div class="post-btn"><img no-lazy src="/blog/images/alipay.png" style="display:none" alt="付款码"> <span class="post-donation-btn">捐助</span> <span class="post-share-btn">分享</span></div><div class="post-comment"><span class="instruction">翻墙之后才能评论哦</span><div id="gitalk-container"></div></div><link rel="stylesheet" href="/blog/css/gitalk.css"><script src="/blog/js/gitalk.js"></script><script type="text/javascript">var gitalk=new Gitalk({clientID:"84249c02e216e3ce376a",clientSecret:"a032ae7096d026eff848b5815da5afde341e9ffd",repo:"meethigher.github.io",owner:"meethigher",admin:["meethigher"],id:location.pathname,distractionFreeMode:"true"});gitalk.render("gitalk-container")</script><div class="busuanzi"><span id="busuanzi_container_page_pv">阅读量<span id="busuanzi_value_page_pv"></span>次</span><script defer src="/blog/js/busuanzi.js"></script></div></article><div class="outline" title="目录"><span class="fa fa-list-alt"></span></div></div></main><script src="https://cdn.jsdelivr.net/gh/meethigher/cdn@9.0/js/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/gh/meethigher/cdn@11/js/layer/layer.js"></script><script src="https://cdn.jsdelivr.net/gh/meethigher/cdn@13/js/instantpage.js"></script><script src="/blog/js/meethigher.js"></script><script>let imgs = $(".post-content.blog-markdown img");imgs.css("width", "100%");</script><script>window.imageLazyLoadSetting={isSPA:!1,processImages:null}</script><script>window.addEventListener("load",function(){var a=/\.(gif|jpg|jpeg|tiff|png)$/i,e=/^data:image\/[a-z]+;base64,/;Array.prototype.slice.call(document.querySelectorAll(".blog-markdown img[data-original]")).forEach(function(t){var r=t.parentNode;"A"===r.tagName&&(r.href.match(a)||r.href.match(e))&&(r.href=t.dataset.original)})})</script><script>!function(t){function e(){n&&(o=Array.prototype.slice.call(document.querySelectorAll("img[data-original]")));for(var e,i,r=0;r<o.length;r++)e=o[r],0<=(i=e.getBoundingClientRect()).bottom&&0<=i.left&&i.top<=(t.innerHeight||document.documentElement.clientHeight)&&function(){var t,e,n,i,a=o[r];t=a,e=function(){o=o.filter(function(t){return a===t&&t.removeAttribute("style"),a!==t})},n=new Image,i=t.getAttribute("data-original"),n.onload=function(){t.src=i,e&&e()},n.src=i}()}t.imageLazyLoadSetting.processImages=e;var n=t.imageLazyLoadSetting.isSPA,o=Array.prototype.slice.call(document.querySelectorAll(".blog-markdown img[data-original]"));e(),t.addEventListener("scroll",function(){var n,o;n=e,o=t,clearTimeout(n.tId),n.tId=setTimeout(function(){n.call(o)},500)})}(this)</script></body></html>